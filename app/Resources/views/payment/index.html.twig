{% extends 'base.html.twig' %}

{% block stylesheets %}
<style>
    

</style>
{% endblock %}


{% block body %}
    <section>
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-12 col-xs-12">
                    <h1>Welcome to Stephane's Lydia test!</h1>
            
                    <div class="content-container" align="center">
                        <div class="row justify-content-md-center ">
                            <div class="col-xs-12 col-sm-10 col-md-8 col-lg-6">
                                <form id="formPayment" method="post" novalidate="novalidate" {{ form_enctype(form) }}>

                                    <div class="form-group">
                                        {{ form_label(form.firstName) }}<br>
                                        {{ form_widget(form.firstName, {'attr' : {'class' : 'form-control', 'placeholder' : 'Ex : Stephane'}}) }}
                                    </div>
                                    <div class="form-group">
                                        {{ form_label(form.lastName) }}<br>
                                        {{ form_widget(form.lastName, {'attr' : {'class' : 'form-control', 'placeholder' : 'Ex : Bolu'}}) }}
                                    </div>
                                    <div class="form-group">
                                        {{ form_label(form.email) }}<br>
                                        {{ form_widget(form.email, {'attr' : {'class' : 'form-control', 'placeholder' : 'Ex : lydia@gmail.com'}}) }}
                                    </div>
                                    
                                    <div align="right">
                                        <button type="submit" form="formPayment" class="btn btn-success" id="submitPayment">Validate</button>
                                    </div>

                                    {{ form_rest(form) }}
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}


{% block javascripts %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function(){
            
            $("#formPayment").submit(function(e) {
                var url = "{{ path('payment_create') }}";
                var button = $('#submitPayment');

                button.html('<img width="20" src="{{ asset("images/ajax-loader.gif") }}">');
                button.attr('disabled', true);

                $.ajax({
                    type: "POST",
                    url: url,
                    data: $("#formPayment").serialize(),
                    success: function(data)
                    {
                        console.log("success");
                        button.html('<span class="glyphicon glyphicon-ok"></span> Payment sent!');
                    }
                });

                e.preventDefault(); // avoid to execute the actual submit of the form.
            });
        });
    </script>
{% endblock %}